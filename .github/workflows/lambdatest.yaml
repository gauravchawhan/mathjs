name: Browser testing on Lambdatest

on:
  push:
    branches:
      - '*'

jobs:
    test-tunnel:
        runs-on: ubuntu-latest
        steps:  
          - name: Start Tunnel
            uses: LambdaTest/LambdaTest-tunnel-action@v2
            id: tunnel
            with:
              user: ${{ secrets.LT_USERNAME }}
              accessKey: ${{ secrets.LT_ACCESS_KEY }}
          - run: npm  install
          - run: npm  run test:lambdatest
            env:
              LT_USERNAME: ${{ secrets.LT_USERNAME }}
              LT_ACCESS_KEY: ${{ secrets.LT_ACCESS_KEY }}
          - name: Export Tunnel Logs for debugging
            uses: actions/upload-artifact@v2
            with:
              name: tunnel_logs
              path: ${{ steps.tunnel.outputs.logFileName }}
            